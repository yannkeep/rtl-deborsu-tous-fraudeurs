<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poste de Travail Plaidoyer Citoyen | Ã‰dition & Export Multiformats</title>
    <meta name="description" content="Outil professionnel de plaidoyer citoyen : mÃ©thodologie VOIR-JUGER-AGIR, cartographie des acteurs, veille citoyenne, export JSON/MD/HTML/PDF.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=DM+Sans:wght@500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-base: #09090b;
            --bg-surface: #18181b;
            --bg-elevated: #27272a;
            --bg-card: #1f1f23;
            --bg-input: #0f0f12;
            
            --accent: #f97316;
            --accent-hover: #fb923c;
            --accent-glow: rgba(249, 115, 22, 0.3);
            
            --success: #22c55e;
            --warning: #eab308;
            --danger: #ef4444;
            --info: #3b82f6;
            
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            
            --border: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(255, 255, 255, 0.15);
            
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 14px;
            
            --sidebar-width: 260px;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-base);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            line-height: 1.6;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           SIDEBAR
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text-primary);
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .logo-text {
            font-family: 'DM Sans', sans-serif;
            font-weight: 700;
            font-size: 1rem;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 1rem 0.75rem;
            overflow-y: auto;
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section-title {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            padding: 0 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.65rem 0.75rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.15s ease;
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }
        
        .nav-item.active {
            background: rgba(249, 115, 22, 0.15);
            color: var(--accent);
        }
        
        .nav-item-icon {
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }
        
        .nav-item-badge {
            margin-left: auto;
            background: var(--accent);
            color: white;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 0.15rem 0.4rem;
            border-radius: 100px;
        }
        
        /* Sidebar Footer */
        .sidebar-footer {
            padding: 1rem;
            border-top: 1px solid var(--border);
        }
        
        .storage-indicator {
            margin-bottom: 1rem;
        }
        
        .storage-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-bottom: 0.4rem;
        }
        
        .storage-bar {
            height: 4px;
            background: var(--bg-elevated);
            border-radius: 100px;
            overflow: hidden;
        }
        
        .storage-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .sidebar-btn {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.15s ease;
        }
        
        .sidebar-btn:hover {
            background: var(--bg-elevated);
            border-color: var(--border-hover);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MAIN CONTENT
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .main {
            flex: 1;
            margin-left: var(--sidebar-width);
            display: flex;
            flex-direction: column;
        }
        
        /* Top Bar */
        .topbar {
            height: 60px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            gap: 1rem;
            position: sticky;
            top: 0;
            z-index: 50;
        }
        
        .topbar-title {
            font-family: 'DM Sans', sans-serif;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .topbar-breadcrumb {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .topbar-actions {
            margin-left: auto;
            display: flex;
            gap: 0.5rem;
        }
        
        .topbar-btn {
            padding: 0.5rem 0.9rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            transition: all 0.15s ease;
        }
        
        .topbar-btn:hover {
            background: var(--bg-elevated);
            border-color: var(--border-hover);
        }
        
        .topbar-btn.primary {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }
        
        .topbar-btn.primary:hover {
            background: var(--accent-hover);
        }
        
        /* Content Area */
        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
        
        /* Panel System */
        .panel {
            display: none;
        }
        
        .panel.active {
            display: block;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           DASHBOARD PANEL
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
        }
        
        .stat-card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .stat-card-icon {
            width: 40px;
            height: 40px;
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }
        
        .stat-card-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .stat-card-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
        }
        
        .stat-card-value.accent { color: var(--accent); }
        .stat-card-value.success { color: var(--success); }
        .stat-card-value.info { color: var(--info); }
        
        /* Progress Section */
        .progress-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .progress-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }
        
        .progress-phases {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }
        
        .progress-phase {
            text-align: center;
        }
        
        .progress-phase-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }
        
        .progress-ring {
            width: 80px;
            height: 80px;
            margin: 0 auto 0.75rem;
            position: relative;
        }
        
        .progress-ring svg {
            transform: rotate(-90deg);
        }
        
        .progress-ring-bg {
            fill: none;
            stroke: var(--bg-elevated);
            stroke-width: 8;
        }
        
        .progress-ring-fill {
            fill: none;
            stroke: var(--accent);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-dasharray: 226;
            stroke-dashoffset: 226;
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .progress-ring-text {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            font-weight: 700;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           FORM PANELS
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .form-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .form-section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .form-section-icon {
            width: 36px;
            height: 36px;
            background: rgba(249, 115, 22, 0.15);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .form-section-title {
            font-size: 1rem;
            font-weight: 600;
        }
        
        .form-section-description {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .form-grid {
            display: grid;
            gap: 1rem;
        }
        
        .form-grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }
        
        .form-label {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .form-input, .form-textarea, .form-select {
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 0.7rem 0.9rem;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.15s ease;
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-hint {
            font-size: 0.7rem;
            color: var(--text-muted);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ACTORS PANEL
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .actors-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        
        .actors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }
        
        .actor-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            transition: all 0.2s ease;
        }
        
        .actor-card:hover {
            border-color: var(--border-hover);
        }
        
        .actor-header {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .actor-avatar {
            width: 44px;
            height: 44px;
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }
        
        .actor-info {
            flex: 1;
        }
        
        .actor-name {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 0.2rem;
        }
        
        .actor-role {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        
        .actor-type {
            font-size: 0.65rem;
            font-weight: 600;
            padding: 0.2rem 0.5rem;
            border-radius: 100px;
            text-transform: uppercase;
        }
        
        .actor-type.ally { background: rgba(34, 197, 94, 0.15); color: var(--success); }
        .actor-type.target { background: rgba(59, 130, 246, 0.15); color: var(--info); }
        .actor-type.opponent { background: rgba(239, 68, 68, 0.15); color: var(--danger); }
        .actor-type.neutral { background: rgba(113, 113, 122, 0.15); color: var(--text-muted); }
        
        .actor-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-top: 0.75rem;
        }
        
        .actor-tag {
            background: var(--bg-elevated);
            padding: 0.2rem 0.5rem;
            border-radius: 100px;
            font-size: 0.65rem;
            color: var(--text-secondary);
        }
        
        .actor-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }
        
        .actor-btn {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--text-muted);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .actor-btn:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }
        
        .actor-btn.danger:hover {
            background: rgba(239, 68, 68, 0.15);
            color: var(--danger);
            border-color: var(--danger);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           EXPORT PANEL
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .export-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .export-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .export-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }
        
        .export-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .export-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .export-description {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        /* Import Zone */
        .import-zone {
            background: var(--bg-card);
            border: 2px dashed var(--border);
            border-radius: var(--radius-lg);
            padding: 3rem;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .import-zone:hover, .import-zone.dragover {
            border-color: var(--accent);
            background: rgba(249, 115, 22, 0.05);
        }
        
        .import-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .import-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .import-description {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }
        
        .import-formats {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .import-format {
            background: var(--bg-elevated);
            padding: 0.3rem 0.6rem;
            border-radius: 100px;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-secondary);
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MODALS
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 2rem;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .modal-close {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: all 0.15s ease;
        }
        
        .modal-close:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }
        
        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }
        
        .modal-btn {
            padding: 0.6rem 1.2rem;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .modal-btn.secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
        }
        
        .modal-btn.primary {
            background: var(--accent);
            border: 1px solid var(--accent);
            color: white;
        }
        
        .modal-btn:hover {
            opacity: 0.9;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           TOAST NOTIFICATIONS
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .toast-container {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .toast {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 0.9rem 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            animation: toast-in 0.3s ease;
        }
        
        @keyframes toast-in {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast.success { border-left: 3px solid var(--success); }
        .toast.error { border-left: 3px solid var(--danger); }
        .toast.info { border-left: 3px solid var(--info); }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           RESPONSIVE
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media (max-width: 1024px) {
            .form-grid-2 {
                grid-template-columns: 1fr;
            }
            
            .progress-phases {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .main {
                margin-left: 0;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="index.html" class="logo">
                <div class="logo-icon">âš–ï¸</div>
                <div class="logo-text">Plaidoyer Citoyen</div>
            </a>
        </div>
        
        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Navigation</div>
                <div class="nav-item active" onclick="showPanel('dashboard')">
                    <span class="nav-item-icon">ğŸ“Š</span>
                    <span>Tableau de bord</span>
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">MÃ©thodologie</div>
                <div class="nav-item" onclick="showPanel('voir')">
                    <span class="nav-item-icon">ğŸ‘ï¸</span>
                    <span>1. VOIR</span>
                </div>
                <div class="nav-item" onclick="showPanel('juger')">
                    <span class="nav-item-icon">âš–ï¸</span>
                    <span>2. JUGER</span>
                </div>
                <div class="nav-item" onclick="showPanel('agir')">
                    <span class="nav-item-icon">âœŠ</span>
                    <span>3. AGIR</span>
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Outils</div>
                <div class="nav-item" onclick="showPanel('actors')">
                    <span class="nav-item-icon">ğŸ‘¥</span>
                    <span>Cartographie Acteurs</span>
                    <span class="nav-item-badge" id="actors-count">0</span>
                </div>
                <div class="nav-item" onclick="showPanel('veille')">
                    <span class="nav-item-icon">ğŸ“¡</span>
                    <span>Veille Citoyenne</span>
                </div>
                <div class="nav-item" onclick="showPanel('message')">
                    <span class="nav-item-icon">ğŸ’¬</span>
                    <span>GÃ©nÃ©rateur Message</span>
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">DonnÃ©es</div>
                <div class="nav-item" onclick="showPanel('export')">
                    <span class="nav-item-icon">ğŸ“¤</span>
                    <span>Import / Export</span>
                </div>
            </div>
        </nav>
        
        <div class="sidebar-footer">
            <div class="storage-indicator">
                <div class="storage-label">
                    <span>Stockage local</span>
                    <span id="storage-size">0 KB</span>
                </div>
                <div class="storage-bar">
                    <div class="storage-fill" id="storage-fill"></div>
                </div>
            </div>
            <button class="sidebar-btn" onclick="saveProject()">
                ğŸ’¾ Sauvegarder
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main">
        <!-- Top Bar -->
        <header class="topbar">
            <h1 class="topbar-title" id="panel-title">Tableau de bord</h1>
            <span class="topbar-breadcrumb" id="panel-breadcrumb">Vue d'ensemble</span>
            
            <div class="topbar-actions">
                <button class="topbar-btn" onclick="resetProject()">
                    ğŸ”„ Nouveau
                </button>
                <button class="topbar-btn primary" onclick="saveProject()">
                    ğŸ’¾ Sauvegarder
                </button>
            </div>
        </header>

        <!-- Content Area -->
        <div class="content">
            <!-- DASHBOARD PANEL -->
            <div class="panel active" id="panel-dashboard">
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-card-icon">ğŸ“</div>
                        </div>
                        <div class="stat-card-label">Progression</div>
                        <div class="stat-card-value accent" id="stat-progress">0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-card-icon">ğŸ‘¥</div>
                        </div>
                        <div class="stat-card-label">Acteurs cartographiÃ©s</div>
                        <div class="stat-card-value info" id="stat-actors">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-card-icon">ğŸ“°</div>
                        </div>
                        <div class="stat-card-label">Articles veille</div>
                        <div class="stat-card-value success" id="stat-articles">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-header">
                            <div class="stat-card-icon">ğŸ“…</div>
                        </div>
                        <div class="stat-card-label">EntrÃ©es journal</div>
                        <div class="stat-card-value" id="stat-journal">0</div>
                    </div>
                </div>

                <div class="progress-section">
                    <h3 class="progress-title">Progression par Phase</h3>
                    <div class="progress-phases">
                        <div class="progress-phase">
                            <div class="progress-phase-label">ğŸ‘ï¸ VOIR</div>
                            <div class="progress-ring">
                                <svg width="80" height="80" viewBox="0 0 80 80">
                                    <circle class="progress-ring-bg" cx="40" cy="40" r="36"/>
                                    <circle class="progress-ring-fill" id="progress-voir-ring" cx="40" cy="40" r="36"/>
                                </svg>
                                <div class="progress-ring-text" id="progress-voir">0%</div>
                            </div>
                        </div>
                        <div class="progress-phase">
                            <div class="progress-phase-label">âš–ï¸ JUGER</div>
                            <div class="progress-ring">
                                <svg width="80" height="80" viewBox="0 0 80 80">
                                    <circle class="progress-ring-bg" cx="40" cy="40" r="36"/>
                                    <circle class="progress-ring-fill" id="progress-juger-ring" cx="40" cy="40" r="36"/>
                                </svg>
                                <div class="progress-ring-text" id="progress-juger">0%</div>
                            </div>
                        </div>
                        <div class="progress-phase">
                            <div class="progress-phase-label">âœŠ AGIR</div>
                            <div class="progress-ring">
                                <svg width="80" height="80" viewBox="0 0 80 80">
                                    <circle class="progress-ring-bg" cx="40" cy="40" r="36"/>
                                    <circle class="progress-ring-fill" id="progress-agir-ring" cx="40" cy="40" r="36"/>
                                </svg>
                                <div class="progress-ring-text" id="progress-agir">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VOIR PANEL -->
            <div class="panel" id="panel-voir">
                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸ¯</div>
                        <div>
                            <div class="form-section-title">Domino du Changement</div>
                            <div class="form-section-description">DÃ©finissez le problÃ¨me et vos motivations</div>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Pourquoi agissez-vous ?</label>
                            <textarea class="form-textarea" data-field="domino_pourquoi" placeholder="Qu'est-ce qui vous pousse Ã  vous engager sur ce sujet ?"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Quelles valeurs dÃ©fendez-vous ?</label>
                            <textarea class="form-textarea" data-field="domino_valeurs" placeholder="Justice sociale, solidaritÃ©, dignitÃ© humaine..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Quels changements souhaitez-vous ?</label>
                            <textarea class="form-textarea" data-field="domino_changements" placeholder="DÃ©crivez la situation souhaitÃ©e"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸŒ¸</div>
                        <div>
                            <div class="form-section-title">Fleur du Pouvoir</div>
                            <div class="form-section-description">Analysez les dimensions du problÃ¨me</div>
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Dimension Ã©conomique</label>
                            <textarea class="form-textarea" data-field="fleur_economique" placeholder="Impacts Ã©conomiques du problÃ¨me"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Dimension politique</label>
                            <textarea class="form-textarea" data-field="fleur_politique" placeholder="Enjeux de pouvoir et dÃ©cisions"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Dimension sociale</label>
                            <textarea class="form-textarea" data-field="fleur_sociale" placeholder="Impacts sur les personnes et groupes"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Dimension culturelle</label>
                            <textarea class="form-textarea" data-field="fleur_culturelle" placeholder="Normes, valeurs, reprÃ©sentations"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- JUGER PANEL -->
            <div class="panel" id="panel-juger">
                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸ”¬</div>
                        <div>
                            <div class="form-section-title">Analyse SWOT</div>
                            <div class="form-section-description">Forces, Faiblesses, OpportunitÃ©s, Menaces</div>
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">ğŸ’ª Forces</label>
                            <textarea class="form-textarea" data-field="swot_forces" placeholder="Vos atouts et ressources"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ğŸ˜“ Faiblesses</label>
                            <textarea class="form-textarea" data-field="swot_faiblesses" placeholder="Vos limites et manques"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">âœ¨ OpportunitÃ©s</label>
                            <textarea class="form-textarea" data-field="swot_opportunites" placeholder="Facteurs externes favorables"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">âš ï¸ Menaces</label>
                            <textarea class="form-textarea" data-field="swot_menaces" placeholder="Risques et obstacles externes"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸŒ³</div>
                        <div>
                            <div class="form-section-title">Les 5 Pourquoi</div>
                            <div class="form-section-description">Remontez aux causes racines du problÃ¨me</div>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Pourquoi #1 - Cause immÃ©diate</label>
                            <input type="text" class="form-input" data-field="why_1" placeholder="Pourquoi ce problÃ¨me existe-t-il ?">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pourquoi #2</label>
                            <input type="text" class="form-input" data-field="why_2" placeholder="Pourquoi cette cause existe-t-elle ?">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pourquoi #3</label>
                            <input type="text" class="form-input" data-field="why_3" placeholder="Pourquoi cette cause existe-t-elle ?">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pourquoi #4</label>
                            <input type="text" class="form-input" data-field="why_4" placeholder="Pourquoi cette cause existe-t-elle ?">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pourquoi #5 - Cause racine</label>
                            <input type="text" class="form-input" data-field="why_5" placeholder="La cause fondamentale">
                        </div>
                    </div>
                </div>
            </div>

            <!-- AGIR PANEL -->
            <div class="panel" id="panel-agir">
                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸ¯</div>
                        <div>
                            <div class="form-section-title">Objectifs SMART</div>
                            <div class="form-section-description">SpÃ©cifique, Mesurable, Atteignable, RÃ©aliste, Temporel</div>
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Objectif principal</label>
                            <textarea class="form-textarea" data-field="smart_objectif" placeholder="Que voulez-vous obtenir concrÃ¨tement ?"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Indicateurs de succÃ¨s</label>
                            <textarea class="form-textarea" data-field="smart_indicateurs" placeholder="Comment mesurerez-vous le succÃ¨s ?"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ã‰chÃ©ance</label>
                            <input type="date" class="form-input" data-field="smart_echeance">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ressources nÃ©cessaires</label>
                            <input type="text" class="form-input" data-field="smart_ressources" placeholder="Budget, personnes, outils...">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸ’¬</div>
                        <div>
                            <div class="form-section-title">Message ClÃ©</div>
                            <div class="form-section-description">Structurez votre argumentaire</div>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Accroche</label>
                            <input type="text" class="form-input" data-field="msg_accroche" placeholder="Phrase d'accroche percutante">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ProblÃ¨me</label>
                            <textarea class="form-textarea" data-field="msg_probleme" placeholder="Description du problÃ¨me"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Importance</label>
                            <textarea class="form-textarea" data-field="msg_importance" placeholder="Pourquoi c'est important"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Demande d'action</label>
                            <textarea class="form-textarea" data-field="msg_action" placeholder="Ce que vous demandez concrÃ¨tement"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ACTORS PANEL -->
            <div class="panel" id="panel-actors">
                <div class="actors-header">
                    <h2 style="font-size: 1.25rem;">Cartographie des Acteurs</h2>
                    <button class="topbar-btn primary" onclick="openModal('actor-modal')">
                        â• Ajouter un acteur
                    </button>
                </div>
                <div class="actors-grid" id="actors-grid">
                    <!-- Actors will be rendered here -->
                </div>
            </div>

            <!-- VEILLE PANEL -->
            <div class="panel" id="panel-veille">
                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸ“¡</div>
                        <div>
                            <div class="form-section-title">Veille Citoyenne</div>
                            <div class="form-section-description">Collectez et organisez vos sources</div>
                        </div>
                    </div>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Titre de l'article</label>
                            <input type="text" class="form-input" id="veille-title" placeholder="Titre ou sujet">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Source</label>
                            <input type="text" class="form-input" id="veille-source" placeholder="MÃ©dia, site web...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">URL</label>
                            <input type="url" class="form-input" id="veille-url" placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">CatÃ©gorie</label>
                            <select class="form-select" id="veille-category">
                                <option value="politique">Politique</option>
                                <option value="social">Social</option>
                                <option value="economie">Ã‰conomie</option>
                                <option value="media">MÃ©dia</option>
                                <option value="juridique">Juridique</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-top: 1rem;">
                        <label class="form-label">Notes</label>
                        <textarea class="form-textarea" id="veille-notes" placeholder="Points clÃ©s, citations..."></textarea>
                    </div>
                    <button class="topbar-btn primary" style="margin-top: 1rem;" onclick="addVeilleItem()">
                        â• Ajouter Ã  la veille
                    </button>
                </div>
                <div id="veille-list" style="margin-top: 1.5rem;">
                    <!-- Veille items will be rendered here -->
                </div>
            </div>

            <!-- MESSAGE PANEL -->
            <div class="panel" id="panel-message">
                <div class="form-section">
                    <div class="form-section-header">
                        <div class="form-section-icon">ğŸ’¬</div>
                        <div>
                            <div class="form-section-title">GÃ©nÃ©rateur de Message</div>
                            <div class="form-section-description">Compilez automatiquement votre message de plaidoyer</div>
                        </div>
                    </div>
                    <button class="topbar-btn primary" onclick="generateMessage()">
                        âœ¨ GÃ©nÃ©rer le message
                    </button>
                    <div id="generated-message" style="margin-top: 1.5rem; display: none;"></div>
                </div>
            </div>

            <!-- EXPORT PANEL -->
            <div class="panel" id="panel-export">
                <h3 style="font-size: 1.1rem; margin-bottom: 1.5rem;">ğŸ“¤ Exporter votre projet</h3>
                <div class="export-grid">
                    <div class="export-card" onclick="exportProject('json')">
                        <div class="export-icon">ğŸ“‹</div>
                        <div class="export-title">JSON</div>
                        <div class="export-description">Format complet, rÃ©importable</div>
                    </div>
                    <div class="export-card" onclick="exportProject('md')">
                        <div class="export-icon">ğŸ“</div>
                        <div class="export-title">Markdown</div>
                        <div class="export-description">Document texte structurÃ©</div>
                    </div>
                    <div class="export-card" onclick="exportProject('html')">
                        <div class="export-icon">ğŸŒ</div>
                        <div class="export-title">HTML</div>
                        <div class="export-description">Page web autonome</div>
                    </div>
                    <div class="export-card" onclick="exportProject('csv')">
                        <div class="export-icon">ğŸ“Š</div>
                        <div class="export-title">CSV</div>
                        <div class="export-description">DonnÃ©es tabulaires</div>
                    </div>
                </div>
                
                <h3 style="font-size: 1.1rem; margin: 2rem 0 1.5rem;">ğŸ“¥ Importer un projet</h3>
                <div class="import-zone" id="import-zone" onclick="document.getElementById('import-file').click()">
                    <div class="import-icon">ğŸ“</div>
                    <div class="import-title">Glissez un fichier ou cliquez</div>
                    <div class="import-description">Importez un projet existant pour continuer votre travail</div>
                    <div class="import-formats">
                        <span class="import-format">JSON</span>
                        <span class="import-format">Markdown</span>
                    </div>
                </div>
                <input type="file" id="import-file" accept=".json,.md" style="display: none;" onchange="importFile(event)">
            </div>
        </div>
    </main>

    <!-- Actor Modal -->
    <div class="modal-overlay" id="actor-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Ajouter un acteur</h3>
                <button class="modal-close" onclick="closeModal('actor-modal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Nom</label>
                        <input type="text" class="form-input" id="actor-name" placeholder="Nom de l'acteur">
                    </div>
                    <div class="form-group">
                        <label class="form-label">RÃ´le / Fonction</label>
                        <input type="text" class="form-input" id="actor-role" placeholder="DÃ©putÃ©, journaliste, association...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select class="form-select" id="actor-type">
                            <option value="ally">ğŸŸ¢ AlliÃ©</option>
                            <option value="target">ğŸ”µ Cible</option>
                            <option value="opponent">ğŸ”´ Adversaire</option>
                            <option value="neutral">âšª Neutre</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Organisation</label>
                        <input type="text" class="form-input" id="actor-org" placeholder="Parti, entreprise, ONG...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea class="form-textarea" id="actor-notes" placeholder="Informations complÃ©mentaires"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="closeModal('actor-modal')">Annuler</button>
                <button class="modal-btn primary" onclick="addActor()">Ajouter</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // APPLICATION STATE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        let appState = {
            meta: {
                version: '3.0',
                created: new Date().toISOString(),
                updated: new Date().toISOString(),
                title: 'Mon Plaidoyer'
            },
            fields: {},
            actors: [],
            veille: [],
            journal: []
        };

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // NAVIGATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const panelTitles = {
            dashboard: { title: 'Tableau de bord', breadcrumb: 'Vue d\'ensemble' },
            voir: { title: '1. VOIR', breadcrumb: 'Observation et analyse du contexte' },
            juger: { title: '2. JUGER', breadcrumb: 'Ã‰valuation et prise de position' },
            agir: { title: '3. AGIR', breadcrumb: 'Planification et action' },
            actors: { title: 'Cartographie des Acteurs', breadcrumb: 'AlliÃ©s, cibles, adversaires' },
            veille: { title: 'Veille Citoyenne', breadcrumb: 'Sources et documentation' },
            message: { title: 'GÃ©nÃ©rateur de Message', breadcrumb: 'Argumentaire de plaidoyer' },
            export: { title: 'Import / Export', breadcrumb: 'Gestion des donnÃ©es' }
        };

        function showPanel(panelId) {
            // Hide all panels
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            // Show selected panel
            document.getElementById(`panel-${panelId}`).classList.add('active');
            
            // Update nav
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            event.target.closest('.nav-item')?.classList.add('active');
            
            // Update topbar
            const info = panelTitles[panelId];
            document.getElementById('panel-title').textContent = info.title;
            document.getElementById('panel-breadcrumb').textContent = info.breadcrumb;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // FIELD MANAGEMENT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function initFields() {
            document.querySelectorAll('[data-field]').forEach(el => {
                const field = el.dataset.field;
                
                // Load saved value
                if (appState.fields[field]) {
                    el.value = appState.fields[field];
                }
                
                // Auto-save on change
                el.addEventListener('input', debounce(() => {
                    appState.fields[field] = el.value;
                    saveState(false);
                    updateStats();
                }, 500));
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ACTORS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function addActor() {
            const actor = {
                id: Date.now(),
                name: document.getElementById('actor-name').value,
                role: document.getElementById('actor-role').value,
                type: document.getElementById('actor-type').value,
                org: document.getElementById('actor-org').value,
                notes: document.getElementById('actor-notes').value
            };
            
            if (!actor.name) {
                showToast('Veuillez entrer un nom', 'error');
                return;
            }
            
            appState.actors.push(actor);
            renderActors();
            closeModal('actor-modal');
            saveState();
            
            // Clear form
            ['actor-name', 'actor-role', 'actor-org', 'actor-notes'].forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        function renderActors() {
            const grid = document.getElementById('actors-grid');
            grid.innerHTML = '';
            
            const typeIcons = {
                ally: 'ğŸŸ¢',
                target: 'ğŸ”µ',
                opponent: 'ğŸ”´',
                neutral: 'âšª'
            };
            
            const typeLabels = {
                ally: 'AlliÃ©',
                target: 'Cible',
                opponent: 'Adversaire',
                neutral: 'Neutre'
            };
            
            appState.actors.forEach(actor => {
                const card = document.createElement('div');
                card.className = 'actor-card';
                card.innerHTML = `
                    <div class="actor-header">
                        <div class="actor-avatar">${typeIcons[actor.type]}</div>
                        <div class="actor-info">
                            <div class="actor-name">${actor.name}</div>
                            <div class="actor-role">${actor.role || 'Non spÃ©cifiÃ©'}</div>
                        </div>
                        <span class="actor-type ${actor.type}">${typeLabels[actor.type]}</span>
                    </div>
                    ${actor.org ? `<div class="actor-tags"><span class="actor-tag">${actor.org}</span></div>` : ''}
                    ${actor.notes ? `<p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.75rem;">${actor.notes}</p>` : ''}
                    <div class="actor-actions">
                        <button class="actor-btn" onclick="editActor(${actor.id})">âœï¸ Modifier</button>
                        <button class="actor-btn danger" onclick="deleteActor(${actor.id})">ğŸ—‘ï¸ Supprimer</button>
                    </div>
                `;
                grid.appendChild(card);
            });
            
            document.getElementById('actors-count').textContent = appState.actors.length;
            document.getElementById('stat-actors').textContent = appState.actors.length;
        }

        function deleteActor(id) {
            appState.actors = appState.actors.filter(a => a.id !== id);
            renderActors();
            saveState();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // VEILLE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function addVeilleItem() {
            const item = {
                id: Date.now(),
                title: document.getElementById('veille-title').value,
                source: document.getElementById('veille-source').value,
                url: document.getElementById('veille-url').value,
                category: document.getElementById('veille-category').value,
                notes: document.getElementById('veille-notes').value,
                date: new Date().toISOString()
            };
            
            if (!item.title) {
                showToast('Veuillez entrer un titre', 'error');
                return;
            }
            
            appState.veille.push(item);
            renderVeille();
            saveState();
            showToast('Article ajoutÃ© Ã  la veille');
            
            // Clear form
            ['veille-title', 'veille-source', 'veille-url', 'veille-notes'].forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        function renderVeille() {
            const list = document.getElementById('veille-list');
            list.innerHTML = '';
            
            const categoryColors = {
                politique: 'var(--danger)',
                social: 'var(--success)',
                economie: 'var(--warning)',
                media: 'var(--info)',
                juridique: 'var(--accent)'
            };
            
            appState.veille.forEach(item => {
                const el = document.createElement('div');
                el.className = 'form-section';
                el.style.borderLeft = `3px solid ${categoryColors[item.category]}`;
                el.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div>
                            <h4 style="font-size: 0.95rem; margin-bottom: 0.25rem;">${item.title}</h4>
                            <p style="font-size: 0.75rem; color: var(--text-muted);">
                                ${item.source} â€¢ ${new Date(item.date).toLocaleDateString('fr-FR')}
                            </p>
                        </div>
                        <span style="font-size: 0.65rem; padding: 0.2rem 0.5rem; background: var(--bg-elevated); border-radius: 100px;">
                            ${item.category}
                        </span>
                    </div>
                    ${item.url ? `<a href="${item.url}" target="_blank" style="font-size: 0.8rem; color: var(--info); display: block; margin-top: 0.5rem;">ğŸ”— ${item.url}</a>` : ''}
                    ${item.notes ? `<p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.75rem;">${item.notes}</p>` : ''}
                `;
                list.appendChild(el);
            });
            
            document.getElementById('stat-articles').textContent = appState.veille.length;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MESSAGE GENERATOR
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function generateMessage() {
            const f = appState.fields;
            
            const message = `
**${f.msg_accroche || '[Accroche Ã  dÃ©finir]'}**

${f.msg_probleme || '[Description du problÃ¨me Ã  complÃ©ter]'}

**Pourquoi c'est important :**
${f.msg_importance || '[Importance Ã  expliquer]'}

**Nous demandons :**
${f.msg_action || '[Actions demandÃ©es Ã  prÃ©ciser]'}

---
*GÃ©nÃ©rÃ© avec Plaidoyer Citoyen*
            `.trim();
            
            const container = document.getElementById('generated-message');
            container.style.display = 'block';
            container.innerHTML = `
                <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1.5rem;">
                    <pre style="white-space: pre-wrap; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.8;">${message}</pre>
                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                        <button class="topbar-btn" onclick="copyMessage()">ğŸ“‹ Copier</button>
                        <button class="topbar-btn" onclick="downloadMessage()">ğŸ’¾ TÃ©lÃ©charger</button>
                    </div>
                </div>
            `;
        }

        function copyMessage() {
            const pre = document.querySelector('#generated-message pre');
            navigator.clipboard.writeText(pre.textContent);
            showToast('Message copiÃ© !');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // EXPORT / IMPORT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function exportProject(format) {
            const filename = `plaidoyer_${new Date().toISOString().slice(0, 10)}`;
            let content, type;
            
            switch (format) {
                case 'json':
                    content = JSON.stringify(appState, null, 2);
                    type = 'application/json';
                    break;
                    
                case 'md':
                    content = generateMarkdown();
                    type = 'text/markdown';
                    break;
                    
                case 'html':
                    content = generateHTML();
                    type = 'text/html';
                    break;
                    
                case 'csv':
                    content = generateCSV();
                    type = 'text/csv';
                    break;
            }
            
            downloadFile(content, `${filename}.${format}`, type);
            showToast(`Export ${format.toUpperCase()} rÃ©ussi !`);
        }

        function generateMarkdown() {
            let md = `# Projet de Plaidoyer Citoyen\n\n`;
            md += `> ExportÃ© le ${new Date().toLocaleDateString('fr-FR')}\n\n`;
            
            md += `## 1. VOIR\n\n`;
            ['domino_pourquoi', 'domino_valeurs', 'domino_changements'].forEach(f => {
                if (appState.fields[f]) {
                    md += `### ${f.replace(/_/g, ' ').replace('domino ', '')}\n${appState.fields[f]}\n\n`;
                }
            });
            
            md += `## 2. JUGER\n\n`;
            ['swot_forces', 'swot_faiblesses', 'swot_opportunites', 'swot_menaces'].forEach(f => {
                if (appState.fields[f]) {
                    md += `### ${f.replace('swot_', '').toUpperCase()}\n${appState.fields[f]}\n\n`;
                }
            });
            
            md += `## 3. AGIR\n\n`;
            if (appState.fields.smart_objectif) {
                md += `### Objectif\n${appState.fields.smart_objectif}\n\n`;
            }
            if (appState.fields.msg_accroche) {
                md += `### Message\n${appState.fields.msg_accroche}\n\n`;
            }
            
            if (appState.actors.length) {
                md += `## Acteurs\n\n`;
                appState.actors.forEach(a => {
                    md += `- **${a.name}** (${a.type}) - ${a.role || 'N/A'}\n`;
                });
            }
            
            return md;
        }

        function generateHTML() {
            return `<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Projet de Plaidoyer Citoyen</title>
    <style>
        body { font-family: system-ui; max-width: 900px; margin: 0 auto; padding: 2rem; background: #0a0f18; color: #f8fafc; }
        h1 { color: #f97316; border-bottom: 2px solid #f97316; padding-bottom: 0.5rem; }
        h2 { color: #3b82f6; margin-top: 2rem; }
        .field { background: #1f1f23; padding: 1.5rem; border-radius: 12px; margin-bottom: 1rem; border-left: 3px solid #f97316; }
        .actor { display: inline-block; background: #27272a; padding: 0.5rem 1rem; border-radius: 100px; margin: 0.25rem; font-size: 0.9rem; }
    </style>
</head>
<body>
    <h1>âš–ï¸ Projet de Plaidoyer Citoyen</h1>
    <p style="color: #71717a;">ExportÃ© le ${new Date().toLocaleDateString('fr-FR')}</p>
    
    ${Object.entries(appState.fields).filter(([k, v]) => v).map(([k, v]) => `
        <div class="field">
            <h3 style="margin: 0 0 0.5rem; font-size: 0.9rem; color: #a1a1aa;">${k.replace(/_/g, ' ').toUpperCase()}</h3>
            <p style="margin: 0;">${v}</p>
        </div>
    `).join('')}
    
    ${appState.actors.length ? `
        <h2>ğŸ‘¥ Acteurs</h2>
        ${appState.actors.map(a => `<span class="actor">${a.name} (${a.type})</span>`).join('')}
    ` : ''}
</body>
</html>`;
        }

        function generateCSV() {
            let csv = 'Type,Champ,Valeur\n';
            
            Object.entries(appState.fields).forEach(([k, v]) => {
                if (v) csv += `Champ,"${k}","${v.replace(/"/g, '""')}"\n`;
            });
            
            appState.actors.forEach(a => {
                csv += `Acteur,"${a.name}","${a.type} - ${a.role || 'N/A'}"\n`;
            });
            
            return csv;
        }

        function downloadFile(content, filename, type) {
            const blob = new Blob([content], { type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    if (file.name.endsWith('.json')) {
                        const loaded = JSON.parse(e.target.result);
                        // Merge avec les valeurs par dÃ©faut pour garantir la structure
                        appState = {
                            meta: loaded.meta || { created: new Date().toISOString(), updated: new Date().toISOString(), title: 'Mon Plaidoyer' },
                            fields: loaded.fields || {},
                            actors: Array.isArray(loaded.actors) ? loaded.actors : [],
                            veille: Array.isArray(loaded.veille) ? loaded.veille : [],
                            journal: Array.isArray(loaded.journal) ? loaded.journal : []
                        };
                    } else if (file.name.endsWith('.md')) {
                        // Basic MD parsing
                        showToast('Import Markdown partiel', 'info');
                    }
                    
                    initFields();
                    renderActors();
                    renderVeille();
                    updateStats();
                    saveState();
                    showToast('Projet importÃ© avec succÃ¨s !');
                } catch (err) {
                    showToast('Erreur lors de l\'import', 'error');
                }
            };
            reader.readAsText(file);
        }

        // Drag & Drop
        const importZone = document.getElementById('import-zone');
        importZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            importZone.classList.add('dragover');
        });
        importZone.addEventListener('dragleave', () => {
            importZone.classList.remove('dragover');
        });
        importZone.addEventListener('drop', (e) => {
            e.preventDefault();
            importZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) {
                const input = document.getElementById('import-file');
                const dt = new DataTransfer();
                dt.items.add(file);
                input.files = dt.files;
                importFile({ target: input });
            }
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // STATISTICS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function updateStats() {
            const filledFields = Object.values(appState.fields).filter(v => v && v.trim()).length;
            const totalFields = 25;
            const progress = Math.min(100, Math.round(filledFields / totalFields * 100));
            
            document.getElementById('stat-progress').textContent = progress + '%';
            document.getElementById('stat-journal').textContent = appState.journal.length;
            
            // Phase progress
            const voirFields = ['domino_pourquoi', 'domino_valeurs', 'domino_changements', 'fleur_economique', 'fleur_politique'];
            const jugerFields = ['swot_forces', 'swot_faiblesses', 'swot_opportunites', 'swot_menaces', 'why_1'];
            const agirFields = ['smart_objectif', 'smart_indicateurs', 'msg_accroche', 'msg_probleme', 'msg_action'];
            
            const calcPhase = (fields) => {
                const filled = fields.filter(f => appState.fields[f] && appState.fields[f].trim()).length;
                return Math.round(filled / fields.length * 100);
            };
            
            const voirProg = calcPhase(voirFields);
            const jugerProg = calcPhase(jugerFields);
            const agirProg = calcPhase(agirFields);
            
            document.getElementById('progress-voir').textContent = voirProg + '%';
            document.getElementById('progress-juger').textContent = jugerProg + '%';
            document.getElementById('progress-agir').textContent = agirProg + '%';
            
            // Update rings (circumference = 2 * PI * 36 â‰ˆ 226)
            const circumference = 226;
            document.getElementById('progress-voir-ring').style.strokeDashoffset = circumference - (circumference * voirProg / 100);
            document.getElementById('progress-juger-ring').style.strokeDashoffset = circumference - (circumference * jugerProg / 100);
            document.getElementById('progress-agir-ring').style.strokeDashoffset = circumference - (circumference * agirProg / 100);
            
            // Storage
            const size = new Blob([JSON.stringify(appState)]).size;
            document.getElementById('storage-size').textContent = (size / 1024).toFixed(1) + ' KB';
            document.getElementById('storage-fill').style.width = Math.min(100, (size / 50000) * 100) + '%';
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // STATE MANAGEMENT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function saveState(notify = true) {
            appState.meta.updated = new Date().toISOString();
            localStorage.setItem('plaidoyer_workstation_v3', JSON.stringify(appState));
            if (notify) showToast('Projet sauvegardÃ©');
        }

        function loadState() {
            const saved = localStorage.getItem('plaidoyer_workstation_v3');
            if (saved) {
                try {
                    const loaded = JSON.parse(saved);
                    // Merge avec les valeurs par dÃ©faut pour garantir la structure
                    appState = {
                        meta: loaded.meta || { created: new Date().toISOString(), updated: new Date().toISOString(), title: 'Mon Plaidoyer' },
                        fields: loaded.fields || {},
                        actors: Array.isArray(loaded.actors) ? loaded.actors : [],
                        veille: Array.isArray(loaded.veille) ? loaded.veille : [],
                        journal: Array.isArray(loaded.journal) ? loaded.journal : []
                    };
                } catch (e) {
                    console.error('Error loading state:', e);
                }
            }
        }

        function saveProject() {
            saveState(true);
        }

        function resetProject() {
            if (confirm('Voulez-vous vraiment crÃ©er un nouveau projet ? Les donnÃ©es non exportÃ©es seront perdues.')) {
                localStorage.removeItem('plaidoyer_workstation_v3');
                location.reload();
            }
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // UI UTILITIES
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span>${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}</span>
                <span>${message}</span>
            `;
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function debounce(fn, ms) {
            let timeout;
            return (...args) => {
                clearTimeout(timeout);
                timeout = setTimeout(() => fn(...args), ms);
            };
        }

        // Close modal on escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal-overlay.active').forEach(m => m.classList.remove('active'));
            }
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveProject();
            }
        });

        // Close modal on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) overlay.classList.remove('active');
            });
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INITIALIZATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        document.addEventListener('DOMContentLoaded', () => {
            loadState();
            initFields();
            renderActors();
            renderVeille();
            updateStats();
        });
    </script>
</body>
</html>
